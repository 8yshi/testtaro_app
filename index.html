<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ | ç„¡æ–™ã§CSVã‹ã‚‰å•é¡Œä½œæˆãƒ»å°åˆ·</title>
    <meta name="description" content="CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‹±å˜èªãƒ†ã‚¹ãƒˆã‚’ç„¡æ–™ã§ç°¡å˜ç”Ÿæˆã€‚ç¯„å›²æŒ‡å®šã€ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œã€å°åˆ·å¯¾å¿œã€‚å­¦æ ¡ãƒ»å¡¾ãƒ»å€‹äººå­¦ç¿’ã«æœ€é©ãªæ•™æä½œæˆãƒ„ãƒ¼ãƒ«ã€‚">
    <meta name="keywords" content="è‹±å˜èªãƒ†ã‚¹ãƒˆ,å˜èªå¸³,CSV,å•é¡Œç”Ÿæˆ,å°åˆ·,è‹±èªå­¦ç¿’,æ•™æä½œæˆ,ç„¡æ–™ãƒ„ãƒ¼ãƒ«,å­¦ç¿’æ”¯æ´">
    <meta name="author" content="English Test Generator">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://profound-naiad-cc998e.netlify.app/">
    <meta property="og:title" content="å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ | ç„¡æ–™ã§CSVã‹ã‚‰å•é¡Œä½œæˆ">
    <meta property="og:description" content="CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‹±å˜èªãƒ†ã‚¹ãƒˆã‚’ç„¡æ–™ã§ç°¡å˜ç”Ÿæˆã€‚ç¯„å›²æŒ‡å®šã€ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œã€å°åˆ·å¯¾å¿œã€‚">
    <meta property="og:site_name" content="è‹±å˜èªãƒ†ã‚¹ãƒˆç”Ÿæˆå™¨">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://profound-naiad-cc998e.netlify.app/">
    <meta property="twitter:title" content="å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ | ç„¡æ–™ã§CSVã‹ã‚‰å•é¡Œä½œæˆ">
    <meta property="twitter:description" content="CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‹±å˜èªãƒ†ã‚¹ãƒˆã‚’ç„¡æ–™ã§ç°¡å˜ç”Ÿæˆã€‚ç¯„å›²æŒ‡å®šã€ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œã€å°åˆ·å¯¾å¿œã€‚">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://profound-naiad-cc998e.netlify.app/">
    
    <!-- JSON-LDæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ",
        "description": "CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‹±å˜èªãƒ†ã‚¹ãƒˆã‚’ç„¡æ–™ã§ç°¡å˜ç”Ÿæˆã§ãã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
        "url": "https://profound-naiad-cc998e.netlify.app/",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "JPY"
        },
        "creator": {
            "@type": "Person",
            "name": "8yshi"
        }
    }
    </script>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Yu Gothic Medium', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            background: white;
            padding: 40px;
            border-radius: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e1e1e1;
        }

        h1 {
            text-align: center;
            color: #222;
            margin-bottom: 40px;
            font-size: 2.2em;
            font-weight: 700;
            letter-spacing: -0.02em;
            position: relative;
        }

        .logo-container {
            position: absolute;
            top: -10px;
            right: 0;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .logo-container:hover {
            transform: scale(1.05);
        }

        .taro-logo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 2px solid #eee;
            overflow: hidden;
        }

        .taro-face {
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMjUiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMCAxNUM0IDE1IDQgMjUgMTAgMjVIMjVIMzVDNDEgMjUgNDEgMTUgMzUgMTVIMjVIMTBaIiBmaWxsPSJibGFjayIvPgo8ZWxsaXBzZSBjeD0iMTYiIGN5PSIyOCIgcng9IjQiIHJ5PSIyIiBmaWxsPSJibGFjayIvPgo8ZWxsaXBzZSBjeD0iMzQiIGN5PSIyOCIgcng9IjQiIHJ5PSIyIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNMjEgMzNMMjUgMzZMMjkgMzMiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xNSA0MEMxNSA0MCAyMCA0MyAyNSA0M0MzMCA0MyAzNSA0MCAzNSA0MCIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz4KPC9zdmc+');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .section {
            margin-bottom: 30px;
            padding: 0;
        }

        .section h3 {
            margin: 0 0 20px 0;
            color: #333;
            font-size: 1.1em;
            font-weight: 600;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }

        .file-input-wrapper {
            position: relative;
            display: block;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
        }

        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-button {
            display: block;
            padding: 12px 16px;
            background: #fff;
            color: #333;
            border: 2px solid #ddd;
            border-radius: 2px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
            text-align: center;
        }

        .file-input-button:hover {
            border-color: #999;
            background: #f8f8f8;
        }

        .input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            align-items: center;
        }

        .input-group label {
            min-width: 100px;
            font-weight: 500;
            color: #555;
            font-size: 14px;
        }

        input[type="number"], 
        input[type="text"], 
        select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
            flex: 1;
            background: white;
        }

        input[type="number"]:focus, 
        input[type="text"]:focus, 
        select:focus {
            outline: none;
            border-color: #666;
        }

        button {
            background: #333;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 2px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 4px 4px 4px 0;
            font-weight: 500;
        }

        button:hover {
            background: #555;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .word-count {
            background: #f8f8f8;
            padding: 12px;
            border-radius: 2px;
            margin-bottom: 16px;
            text-align: left;
            font-weight: 500;
            font-size: 14px;
            border: 1px solid #eee;
        }

        .error {
            color: #d32f2f;
            background: #ffebee;
            padding: 12px;
            border-radius: 2px;
            margin-top: 10px;
            border: 1px solid #ffcdd2;
            font-size: 14px;
        }

        .success {
            color: #388e3c;
            background: #e8f5e8;
            padding: 12px;
            border-radius: 2px;
            margin-top: 10px;
            border: 1px solid #c8e6c9;
            font-size: 14px;
        }

        .help-text {
            font-size: 12px;
            color: #666;
            margin-top: 6px;
            line-height: 1.4;
        }

        /* å°åˆ·ãƒ»è¡¨ç¤ºç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .printable-test {
            background: white;
            color: black;
            padding: 30px;
            margin: 20px 0;
            border-radius: 2px;
            font-family: 'Yu Gothic Medium', 'Hiragino Sans', 'Meiryo', sans-serif;
            font-size: 16px;
            line-height: 1.8;
            max-width: 100%;
            border: 1px solid #ddd;
        }

        .test-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
        }

        .test-title {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #222;
        }

        .test-info {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 10px;
            color: #555;
        }

        .name-score {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #555;
        }

        .test-questions {
            margin: 30px 0;
        }

        .print-question {
            margin-bottom: 20px;
            page-break-inside: avoid;
        }

        .question-text {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
            line-height: 1.3;
            color: #222;
        }

        .answer-line {
            border-bottom: 1px solid #333;
            height: 20px;
            margin-top: 8px;
            display: inline-block;
            min-width: 200px;
        }

        .answer-section {
            margin-top: 50px;
            border-top: 1px solid #333;
            padding-top: 30px;
        }

        .answer-title {
            text-align: center;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 30px;
            color: #222;
        }

        .answer-item {
            margin-bottom: 12px;
            font-size: 16px;
            line-height: 1.4;
            color: #333;
        }

        .print-buttons {
            text-align: center;
            margin: 20px 0;
            padding: 20px 0;
            border-top: 1px solid #eee;
        }

        .print-footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            font-size: 10px;
            color: #666;
        }

        @media print {
            body {
                background: white !important;
                padding: 0 !important;
            }
            
            .container {
                box-shadow: none !important;
                border: none !important;
                padding: 0 !important;
            }
            
            .section {
                display: none !important;
            }
            
            .print-buttons {
                display: none !important;
            }
            
            .printable-test {
                border: none !important;
                margin: 0 !important;
                padding: 20px !important;
            }
        }

        /* ãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 2px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .close {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            color: #666;
        }

        .close:hover {
            color: #000;
        }

        .modal h2 {
            margin-top: 0;
            color: #222;
            font-weight: 600;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .modal h3 {
            color: #333;
            font-weight: 600;
            margin-top: 24px;
            margin-bottom: 12px;
        }

        .modal p, .modal li {
            line-height: 1.6;
            color: #555;
            margin-bottom: 12px;
        }

        .modal ul {
            padding-left: 20px;
        }

        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            .input-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .input-group label {
                margin-bottom: 4px;
                min-width: auto;
            }
            
            button {
                width: 100%;
                margin: 4px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ
            <div class="logo-container" onclick="openModal()">
                <div class="taro-logo">
                    <div class="taro-face"></div>
                </div>
            </div>
        </h1>
        
        <div class="section">
            <h3>ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿</h3>
            <div class="file-input-wrapper">
                <input type="file" id="csvFile" class="file-input" accept=".csv" />
                <div class="file-input-button">CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
            </div>
            <div class="help-text">å½¢å¼: ç•ªå·, å˜èª, æ„å‘³ ã®é †ã§3åˆ—</div>
            <div id="fileStatus"></div>
        </div>

        <div class="section">
            <h3>ãƒ†ã‚¹ãƒˆè¨­å®š</h3>
            <div class="input-group">
                <label>é–‹å§‹ç•ªå·</label>
                <input type="number" id="startNum" value="1" min="1">
            </div>
            <div class="input-group">
                <label>çµ‚äº†ç•ªå·</label>
                <input type="number" id="endNum" value="100" min="1">
            </div>
            <div class="input-group">
                <label>å•é¡Œæ•°</label>
                <input type="number" id="questionCount" value="20" min="1" max="50">
            </div>
            <div class="input-group">
                <label>å‡ºé¡Œå½¢å¼</label>
                <select id="testType">
                    <option value="english-to-japanese">å˜èª â†’ æ„å‘³</option>
                    <option value="japanese-to-english">æ„å‘³ â†’ å˜èª</option>
                    <option value="mixed">ãƒŸãƒƒã‚¯ã‚¹</option>
                </select>
            </div>
            <div class="input-group">
                <label>å¿…å‡ºå•é¡Œ</label>
                <input type="text" id="requiredQuestions" placeholder="ä¾‹: 5,12,23,67">
            </div>
            <div class="help-text">å¿…ãšå‡ºé¡Œã—ãŸã„å˜èªã®ç•ªå·ã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å…¥åŠ›</div>
            <div id="rangeStatus" class="word-count"></div>
        </div>

        <div class="section">
            <h3>ãƒ†ã‚¹ãƒˆç”Ÿæˆ</h3>
            <button id="generateTest" disabled>ãƒ†ã‚¹ãƒˆå•é¡Œã‚’ç”Ÿæˆ</button>
            <div id="generateStatus"></div>
        </div>

        <!-- å°åˆ·ç”¨ãƒ†ã‚¹ãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div id="printableTest" style="display:none;">
            <div class="print-buttons">
                <button onclick="window.print()">å°åˆ·ã™ã‚‹</button>
                <button onclick="showAnswers()" id="showAnswersBtn">è§£ç­”ã‚’è¡¨ç¤º</button>
                <button onclick="hideAnswers()" id="hideAnswersBtn" style="display:none;">è§£ç­”ã‚’éš ã™</button>
            </div>
            
            <div class="printable-test" id="printTest">
                <div class="test-header">
                    <div class="test-title">å˜èªãƒ†ã‚¹ãƒˆ</div>
                    <div class="test-info">
                        <span id="printDate"></span>
                        <span id="printQuestionCount"></span>
                    </div>
                    <div class="name-score">
                        <span>åå‰: ___________________</span>
                        <span id="printScore"></span>
                    </div>
                </div>
                
                <div class="test-questions" id="printQuestions">
                    <!-- å•é¡ŒãŒã“ã“ã«æŒ¿å…¥ã•ã‚Œã‚‹ -->
                </div>
                
                <div class="answer-section" id="answerSection" style="display:none;">
                    <div class="answer-title">è§£ç­”</div>
                    <div id="printAnswers">
                        <!-- è§£ç­”ãŒã“ã“ã«æŒ¿å…¥ã•ã‚Œã‚‹ -->
                    </div>
                </div>
                
                <div class="print-footer">
                    Generated by å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ (https://profound-naiad-cc998e.netlify.app)
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            
            <h2>å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒã«ã¤ã„ã¦</h2>
            
            <h3>ğŸ“š ã‚µãƒ¼ãƒ“ã‚¹æ¦‚è¦</h3>
            <p>å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒã¯ã€CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å˜èªãƒ†ã‚¹ãƒˆã‚’ç°¡å˜ã«ç”Ÿæˆã§ãã‚‹ç„¡æ–™ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚å­¦æ ¡ãƒ»å¡¾ãƒ»å€‹äººå­¦ç¿’ã§ã®æ•™æä½œæˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚</p>
            
            <h3>âœ¨ ä¸»ãªæ©Ÿèƒ½</h3>
            <ul>
                <li>CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®å˜èªãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿</li>
                <li>å‡ºé¡Œç¯„å›²ã®è‡ªç”±è¨­å®š</li>
                <li>å¿…å‡ºå•é¡Œã®æŒ‡å®šæ©Ÿèƒ½</li>
                <li>è¤‡æ•°ã®å‡ºé¡Œå½¢å¼ï¼ˆå˜èªâ†’æ„å‘³ã€æ„å‘³â†’å˜èªã€ãƒŸãƒƒã‚¯ã‚¹ï¼‰</li>
                <li>å°åˆ·å¯¾å¿œã®ç¾ã—ã„ãƒ†ã‚¹ãƒˆç”¨ç´™ç”Ÿæˆ</li>
                <li>è§£ç­”ç”¨ç´™ã®è‡ªå‹•ç”Ÿæˆ</li>
            </ul>
            
            <h3>ğŸ¯ å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼</h3>
            <ul>
                <li>è‹±èªæ•™å¸«ãƒ»è¬›å¸«ã®æ–¹</li>
                <li>å¡¾ãƒ»äºˆå‚™æ ¡é–¢ä¿‚è€…</li>
                <li>å­¦ç¿’è€…ï¼ˆé«˜æ ¡ç”Ÿãƒ»å¤§å­¦ç”Ÿãƒ»ç¤¾ä¼šäººï¼‰</li>
                <li>ä¿è­·è€…ã®æ–¹</li>
            </ul>
            
            <h3>ğŸ“„ CSVãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼</h3>
            <p>ä»¥ä¸‹ã®å½¢å¼ã§CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š</p>
            <p><code>ç•ªå·,å˜èª,æ„å‘³</code></p>
            <p>ä¾‹ï¼š<code>1,"apple","ã‚Šã‚“ã”"</code></p>
            
            <h3>ğŸ”’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</h3>
            
            <h4>æƒ…å ±ã®åé›†</h4>
            <p>å½“ã‚µã‚¤ãƒˆã§ã¯ä»¥ä¸‹ã®æƒ…å ±ã‚’åé›†ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼š</p>
            <ul>
                <li>ã‚¢ã‚¯ã‚»ã‚¹è§£æã®ãŸã‚ã®åŒ¿åãƒ‡ãƒ¼ã‚¿ï¼ˆGoogle Analyticsï¼‰</li>
                <li>ã‚µã‚¤ãƒˆæ”¹å–„ã®ãŸã‚ã®åˆ©ç”¨çŠ¶æ³ãƒ‡ãƒ¼ã‚¿</li>
            </ul>
            
            <h4>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã®å–ã‚Šæ‰±ã„</h4>
            <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸCSVãƒ•ã‚¡ã‚¤ãƒ«ã¯ï¼š</p>
            <ul>
                <li>ãŠå®¢æ§˜ã®ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§ã®ã¿å‡¦ç†ã•ã‚Œã¾ã™</li>
                <li>ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ãƒ»ä¿å­˜ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“</li>
                <li>ç¬¬ä¸‰è€…ã«å…±æœ‰ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“</li>
            </ul>
            
            <h4>Cookie ã®ä½¿ç”¨</h4>
            <p>å½“ã‚µã‚¤ãƒˆã§ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹å‘ä¸Šã®ãŸã‚ã«Cookieã‚’ä½¿ç”¨ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã§Cookieã‚’ç„¡åŠ¹ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
            
            <h4>ç¬¬ä¸‰è€…ã‚µãƒ¼ãƒ“ã‚¹</h4>
            <p>å½“ã‚µã‚¤ãƒˆã§ã¯ä»¥ä¸‹ã®ç¬¬ä¸‰è€…ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ï¼š</p>
            <ul>
                <li>Google Analyticsï¼ˆã‚¢ã‚¯ã‚»ã‚¹è§£æï¼‰</li>
                <li>Netlifyï¼ˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ï¼‰</li>
            </ul>
            
            <h4>å…è²¬äº‹é …</h4>
            <p>å½“ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ©ç”¨ã«ã‚ˆã‚Šç”Ÿã˜ãŸæå®³ã«ã¤ã„ã¦ã€é‹å–¶è€…ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚ãŠå®¢æ§˜ã®è²¬ä»»ã«ãŠã„ã¦ã”åˆ©ç”¨ãã ã•ã„ã€‚</p>
            
            <h4>ãŠå•ã„åˆã‚ã›</h4>
            <p>ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã«é–¢ã™ã‚‹ã”è³ªå•ã¯ã€GitHubã®Issueã‚ˆã‚ŠãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
            
            <p><strong>æœ€çµ‚æ›´æ–°æ—¥ï¼š2025å¹´8æœˆ10æ—¥</strong></p>
        </div>
    </div>

    <script>
        let vocabularyData = [];
        let currentTest = [];

        // CSVãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    parseCSV(event.target.result);
                    document.querySelector('.file-input-button').textContent = `é¸æŠæ¸ˆã¿: ${file.name}`;
                    updateRangeStatus();
                } catch (error) {
                    showError('CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                }
            };
            reader.readAsText(file, 'UTF-8');
        });

        // CSVè§£æ
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            vocabularyData = [];

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;

                const columns = parseCSVLine(line);
                
                if (columns.length >= 3) {
                    const num = parseInt(columns[0]);
                    const english = columns[1].trim().replace(/^"|"$/g, '');
                    const japanese = columns[2].trim().replace(/^"|"$/g, '');
                    
                    if (!isNaN(num) && english && japanese) {
                        vocabularyData.push({
                            number: num,
                            english: english,
                            japanese: japanese
                        });
                    }
                }
            }

            if (vocabularyData.length === 0) {
                throw new Error('æœ‰åŠ¹ãªå˜èªãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
            }

            vocabularyData.sort((a, b) => a.number - b.number);
            showSuccess(`${vocabularyData.length}å€‹ã®å˜èªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
            
            const maxNum = Math.max(...vocabularyData.map(item => item.number));
            document.getElementById('endNum').value = maxNum;
            
            document.getElementById('generateTest').disabled = false;
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }

        function updateRangeStatus() {
            const startNum = parseInt(document.getElementById('startNum').value);
            const endNum = parseInt(document.getElementById('endNum').value);
            const requiredQuestions = document.getElementById('requiredQuestions').value;
            
            if (vocabularyData.length > 0) {
                const availableWords = vocabularyData.filter(item => 
                    item.number >= startNum && item.number <= endNum
                );
                
                const statusDiv = document.getElementById('rangeStatus');
                let statusText = `æŒ‡å®šç¯„å›²å†…ã®å˜èªæ•°: ${availableWords.length}å€‹`;
                
                // å¿…å‡ºå•é¡Œã®ãƒã‚§ãƒƒã‚¯
                if (requiredQuestions.trim()) {
                    const requiredNums = parseRequiredQuestions(requiredQuestions);
                    const validRequired = requiredNums.filter(num => 
                        num >= startNum && num <= endNum && 
                        vocabularyData.some(item => item.number === num)
                    );
                    
                    if (validRequired.length > 0) {
                        statusText += ` | å¿…å‡ºå•é¡Œ: ${validRequired.length}å€‹`;
                    }
                    
                    const invalidRequired = requiredNums.filter(num => 
                        num < startNum || num > endNum || 
                        !vocabularyData.some(item => item.number === num)
                    );
                    
                    if (invalidRequired.length > 0) {
                        statusText += ` | ç„¡åŠ¹ãªç•ªå·: ${invalidRequired.join(',')}`;
                    }
                }
                
                statusDiv.textContent = statusText;
                
                const questionCount = parseInt(document.getElementById('questionCount').value);
                if (availableWords.length < questionCount) {
                    statusDiv.textContent += ` (å•é¡Œæ•°ã‚’${availableWords.length}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„)`;
                    statusDiv.style.color = '#d32f2f';
                } else {
                    statusDiv.style.color = '#388e3c';
                }
            }
        }

        // ãƒ†ã‚¹ãƒˆç”Ÿæˆ
        document.getElementById('generateTest').addEventListener('click', function() {
            try {
                generateTest();
                createPrintableTest();
                showSuccess('ãƒ†ã‚¹ãƒˆå•é¡Œã‚’ç”Ÿæˆã—ã¾ã—ãŸï¼å°åˆ·ã¾ãŸã¯ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã§ã”åˆ©ç”¨ãã ã•ã„ã€‚');
            } catch (error) {
                showError('ãƒ†ã‚¹ãƒˆç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
            }
        });

        function generateTest() {
            const startNum = parseInt(document.getElementById('startNum').value);
            const endNum = parseInt(document.getElementById('endNum').value);
            const questionCount = parseInt(document.getElementById('questionCount').value);
            const testType = document.getElementById('testType').value;
            const requiredQuestions = document.getElementById('requiredQuestions').value;

            // ç¯„å›²å†…ã®å˜èªã‚’å–å¾—
            const availableWords = vocabularyData.filter(item => 
                item.number >= startNum && item.number <= endNum
            );

            if (availableWords.length < questionCount) {
                throw new Error(`ç¯„å›²å†…ã®å˜èªæ•°(${availableWords.length}å€‹)ãŒå•é¡Œæ•°(${questionCount}å€‹)ã‚ˆã‚Šå°‘ãªã„ã§ã™`);
            }

            // å¿…å‡ºå•é¡Œã®å‡¦ç†
            let requiredWords = [];
            if (requiredQuestions.trim()) {
                const requiredNums = parseRequiredQuestions(requiredQuestions);
                requiredWords = vocabularyData.filter(item => 
                    requiredNums.includes(item.number) && 
                    item.number >= startNum && 
                    item.number <= endNum
                );
                
                if (requiredWords.length > questionCount) {
                    throw new Error(`å¿…å‡ºå•é¡Œæ•°(${requiredWords.length}å€‹)ãŒç·å•é¡Œæ•°(${questionCount}å€‹)ã‚ˆã‚Šå¤šã„ã§ã™`);
                }
            }

            // ãƒ©ãƒ³ãƒ€ãƒ å•é¡Œã®é¸æŠï¼ˆå¿…å‡ºå•é¡Œã‚’é™¤ãï¼‰
            const remainingWords = availableWords.filter(word => 
                !requiredWords.some(req => req.number === word.number)
            );
            
            const randomCount = questionCount - requiredWords.length;
            const shuffledRemaining = remainingWords.sort(() => 0.5 - Math.random());
            const randomWords = shuffledRemaining.slice(0, randomCount);

            // å¿…å‡ºå•é¡Œ + ãƒ©ãƒ³ãƒ€ãƒ å•é¡Œã‚’çµåˆã—ã¦ã‚·ãƒ£ãƒƒãƒ•ãƒ«
            const allSelectedWords = [...requiredWords, ...randomWords];
            const finalShuffled = allSelectedWords.sort(() => 0.5 - Math.random());

            currentTest = finalShuffled.map((word, index) => {
                let questionType;
                if (testType === 'mixed') {
                    questionType = Math.random() < 0.5 ? 'english-to-japanese' : 'japanese-to-english';
                } else {
                    questionType = testType;
                }

                return {
                    number: index + 1,
                    word: word,
                    type: questionType,
                    isRequired: requiredWords.some(req => req.number === word.number)
                };
            });
        }

        // å¿…å‡ºå•é¡Œç•ªå·ã‚’ãƒ‘ãƒ¼ã‚¹
        function parseRequiredQuestions(input) {
            if (!input.trim()) return [];
            
            return input.split(',')
                .map(s => parseInt(s.trim()))
                .filter(num => !isNaN(num) && num > 0);
        }

        function createPrintableTest() {
            const today = new Date();
            const dateStr = `${today.getFullYear()}å¹´${today.getMonth() + 1}æœˆ${today.getDate()}æ—¥`;
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±è¨­å®š
            document.getElementById('printDate').textContent = `å®Ÿæ–½æ—¥: ${dateStr}`;
            document.getElementById('printQuestionCount').textContent = `å•é¡Œæ•°: ${currentTest.length}å•`;
            document.getElementById('printScore').textContent = `ç‚¹æ•°: _____ / ${currentTest.length}`;
            
            // å•é¡Œç”Ÿæˆ
            const questionsDiv = document.getElementById('printQuestions');
            questionsDiv.innerHTML = '';
            
            currentTest.forEach(item => {
                const question = item.type === 'english-to-japanese' 
                    ? item.word.english 
                    : item.word.japanese;
                
                const questionDiv = document.createElement('div');
                questionDiv.className = 'print-question';
                questionDiv.innerHTML = `
                    <div class="question-text">å•${item.number}. ${question}</div>
                    <div>ç­”ãˆ: <span class="answer-line"></span></div>
                `;
                questionsDiv.appendChild(questionDiv);
            });
            
            // è§£ç­”ç”Ÿæˆ
            const answersDiv = document.getElementById('printAnswers');
            answersDiv.innerHTML = '';
            
            currentTest.forEach(item => {
                const answer = item.type === 'english-to-japanese' 
                    ? item.word.japanese 
                    : item.word.english;
                
                const answerDiv = document.createElement('div');
                answerDiv.className = 'answer-item';
                answerDiv.textContent = `å•${item.number}. ${answer} (å˜èª${item.word.number})`;
                answersDiv.appendChild(answerDiv);
            });
            
            // å°åˆ·ç”¨ã‚¨ãƒªã‚¢è¡¨ç¤º
            document.getElementById('printableTest').style.display = 'block';
        }

        function showAnswers() {
            document.getElementById('answerSection').style.display = 'block';
            document.getElementById('showAnswersBtn').style.display = 'none';
            document.getElementById('hideAnswersBtn').style.display = 'inline-block';
        }

        function hideAnswers() {
            document.getElementById('answerSection').style.display = 'none';
            document.getElementById('showAnswersBtn').style.display = 'inline-block';
            document.getElementById('hideAnswersBtn').style.display = 'none';
        }

        // å…¥åŠ›å€¤å¤‰æ›´æ™‚ã«ç¯„å›²çŠ¶æ…‹æ›´æ–°
        ['startNum', 'endNum', 'questionCount', 'requiredQuestions'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateRangeStatus);
        });

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function showError(message) {
            const statusDiv = document.getElementById('generateStatus') || document.getElementById('fileStatus');
            statusDiv.innerHTML = `<div class="error">${message}</div>`;
        }

        function showSuccess(message) {
            const statusDiv = document.getElementById('generateStatus') || document.getElementById('fileStatus');
            statusDiv.innerHTML = `<div class="success">${message}</div>`;
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡
        function openModal() {
            document.getElementById('infoModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('infoModal').style.display = 'none';
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
        window.onclick = function(event) {
            const modal = document.getElementById('infoModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>
