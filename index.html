<!DOCTYPE html>
<html lang="ja">
<head>
     <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ | ç„¡æ–™ã§CSVã‹ã‚‰å•é¡Œä½œæˆãƒ»å°åˆ·</title>
    <meta name="description" content="CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‹±å˜èªãƒ†ã‚¹ãƒˆã‚’ç„¡æ–™ã§ç°¡å˜ç”Ÿæˆã€‚ç¯„å›²æŒ‡å®šã€ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œã€å°åˆ·å¯¾å¿œã€‚å­¦æ ¡ãƒ»å¡¾ãƒ»å€‹äººå­¦ç¿’ã«æœ€é©ãªæ•™æä½œæˆãƒ„ãƒ¼ãƒ«ã€‚">
    <meta name="keywords" content="è‹±å˜èªãƒ†ã‚¹ãƒˆ,å˜èªå¸³,CSV,å•é¡Œç”Ÿæˆ,å°åˆ·,è‹±èªå­¦ç¿’,æ•™æä½œæˆ,ç„¡æ–™ãƒ„ãƒ¼ãƒ«,å­¦ç¿’æ”¯æ´">
    <meta name="author" content="English Test Generator">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://profound-naiad-cc998e.netlify.app/">
    <meta property="og:title" content="å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ | ç„¡æ–™ã§CSVã‹ã‚‰å•é¡Œä½œæˆ">
    <meta property="og:description" content="CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‹±å˜èªãƒ†ã‚¹ãƒˆã‚’ç„¡æ–™ã§ç°¡å˜ç”Ÿæˆã€‚ç¯„å›²æŒ‡å®šã€ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œã€å°åˆ·å¯¾å¿œã€‚">
    <meta property="og:site_name" content="è‹±å˜èªãƒ†ã‚¹ãƒˆç”Ÿæˆå™¨">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://profound-naiad-cc998e.netlify.app/">
    <meta property="twitter:title" content="å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ | ç„¡æ–™ã§CSVã‹ã‚‰å•é¡Œä½œæˆ">
    <meta property="twitter:description" content="CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‹±å˜èªãƒ†ã‚¹ãƒˆã‚’ç„¡æ–™ã§ç°¡å˜ç”Ÿæˆã€‚ç¯„å›²æŒ‡å®šã€ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œã€å°åˆ·å¯¾å¿œã€‚">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://profound-naiad-cc998e.netlify.app/">
    
    <!-- JSON-LDæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ",
        "description": "CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‹±å˜èªãƒ†ã‚¹ãƒˆã‚’ç„¡æ–™ã§ç°¡å˜ç”Ÿæˆã§ãã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
        "url": "https://profound-naiad-cc998e.netlify.app/",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "JPY"
        },
        "creator": {
            "@type": "Person",
            "name": "8yshi"
        }
    }
    </script>
    <style>
        body {
            font-family: 'Arial', 'Yu Gothic Medium', 'Hiragino Sans', 'Meiryo', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 30px;
            font-size: 2.2em;
        }

        .section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
            border-left: 4px solid #4299e1;
        }

        .section h3 {
            margin-top: 0;
            color: #2d3748;
            font-size: 1.3em;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 100%;
        }

        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-button {
            display: inline-block;
            padding: 12px 24px;
            background: #4299e1;
            color: white;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
            width: 100%;
            text-align: center;
            box-sizing: border-box;
        }

        .file-input-button:hover {
            background: #3182ce;
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
        }

        .input-group label {
            min-width: 100px;
            font-weight: bold;
        }

        input[type="number"], select {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 16px;
            flex: 1;
        }

        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #4299e1;
        }

        button {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.4);
        }

        button:disabled {
            background: #a0aec0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .word-count {
            background: #bee3f8;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }

        .error {
            color: #e53e3e;
            background: #fed7d7;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
        }

        .success {
            color: #38a169;
            background: #c6f6d5;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
        }

        /* å°åˆ·ãƒ»è¡¨ç¤ºç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .printable-test {
            background: white;
            color: black;
            padding: 30px;
            margin: 20px 0;
            border-radius: 8px;
            font-family: 'Yu Gothic Medium', 'Hiragino Sans', 'Meiryo', sans-serif;
            font-size: 16px;
            line-height: 1.8;
            max-width: 100%;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .test-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
        }

        .test-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .test-info {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .name-score {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .test-questions {
            margin: 30px 0;
        }

        .print-question {
            margin-bottom: 20px;
            page-break-inside: avoid;
        }

        .question-text {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
            line-height: 1.3;
        }

        .answer-line {
            border-bottom: 2px solid #333;
            height: 20px;
            margin-top: 5px;
        }

        .answer-section {
            margin-top: 50px;
            border-top: 2px solid #333;
            padding-top: 30px;
        }

        .answer-title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .answer-item {
            margin-bottom: 10px;
            font-size: 16px;
            line-height: 1.4;
        }

        .print-buttons {
            text-align: center;
            margin: 20px 0;
        }

        .print-footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            font-size: 10px;
            color: #666;
        }

        @media print {
            body {
                background: white !important;
                padding: 0 !important;
            }
            
            .container {
                box-shadow: none !important;
                border-radius: 0 !important;
                padding: 0 !important;
            }
            
            .section {
                display: none !important;
            }
            
            .print-buttons {
                display: none !important;
            }
            
            .printable-test {
                box-shadow: none !important;
                margin: 0 !important;
                padding: 20px !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“š å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ</h1>
        
        <div class="section">
            <h3>ğŸ“ CSVãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿</h3>
            <div class="file-input-wrapper">
                <input type="file" id="csvFile" class="file-input" accept=".csv" />
                <div class="file-input-button">CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
            </div>
            <div id="fileStatus"></div>
        </div>

        <div class="section">
            <h3>âš™ï¸ ãƒ†ã‚¹ãƒˆè¨­å®š</h3>
            <div class="input-group">
                <label>é–‹å§‹ç•ªå·:</label>
                <input type="number" id="startNum" value="1" min="1">
            </div>
            <div class="input-group">
                <label>çµ‚äº†ç•ªå·:</label>
                <input type="number" id="endNum" value="100" min="1">
            </div>
            <div class="input-group">
                <label>å•é¡Œæ•°:</label>
                <input type="number" id="questionCount" value="20" min="1" max="50">
            </div>
            <div class="input-group">
                <label>å‡ºé¡Œå½¢å¼:</label>
                <select id="testType">
                    <option value="english-to-japanese">å˜èª â†’ æ„å‘³</option>
                    <option value="japanese-to-english">æ„å‘³ â†’ å˜èª</option>
                    <option value="mixed">ãƒŸãƒƒã‚¯ã‚¹</option>
                </select>
            </div>
            <div id="rangeStatus" class="word-count"></div>
        </div>

        <div class="section">
            <h3>ğŸ¯ ãƒ†ã‚¹ãƒˆç”Ÿæˆ</h3>
            <button id="generateTest" disabled>ãƒ†ã‚¹ãƒˆå•é¡Œã‚’ç”Ÿæˆ</button>
            <div id="generateStatus"></div>
        </div>

        <!-- å°åˆ·ç”¨ãƒ†ã‚¹ãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div id="printableTest" style="display:none;">
            <div class="print-buttons">
                <button onclick="window.print()">ğŸ–¨ï¸ å°åˆ·ã™ã‚‹</button>
                <button onclick="showAnswers()" id="showAnswersBtn">ğŸ“ è§£ç­”ã‚’è¡¨ç¤º</button>
                <button onclick="hideAnswers()" id="hideAnswersBtn" style="display:none;">âŒ è§£ç­”ã‚’éš ã™</button>
            </div>
            
            <div class="printable-test" id="printTest">
                <div class="test-header">
                    <div class="test-title">å˜èªãƒ†ã‚¹ãƒˆ</div>
                    <div class="test-info">
                        <span id="printDate"></span>
                        <span id="printQuestionCount"></span>
                    </div>
                    <div class="name-score">
                        <span>åå‰: ___________________</span>
                        <span id="printScore"></span>
                    </div>
                </div>
                
                <div class="test-questions" id="printQuestions">
                    <!-- å•é¡ŒãŒã“ã“ã«æŒ¿å…¥ã•ã‚Œã‚‹ -->
                </div>
                
                <div class="answer-section" id="answerSection" style="display:none;">
                    <div class="answer-title">è§£ç­”</div>
                    <div id="printAnswers">
                        <!-- è§£ç­”ãŒã“ã“ã«æŒ¿å…¥ã•ã‚Œã‚‹ -->
                  </div>
                </div>
                
                <div class="print-footer">
                    Generated by å˜èªãƒ†ã‚¹ãƒˆå¤ªéƒ (https://profound-naiad-cc998e.netlify.app)
                </div>
            </div>
        </div>
    </div>

    <script>
        let vocabularyData = [];
        let currentTest = [];

        // CSVãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    parseCSV(event.target.result);
                    document.querySelector('.file-input-button').textContent = `é¸æŠæ¸ˆã¿: ${file.name}`;
                    updateRangeStatus();
                } catch (error) {
                    showError('CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                }
            };
            reader.readAsText(file, 'UTF-8');
        });

        // CSVè§£æ
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            vocabularyData = [];

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;

                const columns = parseCSVLine(line);
                
                if (columns.length >= 3) {
                    const num = parseInt(columns[0]);
                    const english = columns[1].trim().replace(/^"|"$/g, '');
                    const japanese = columns[2].trim().replace(/^"|"$/g, '');
                    
                    if (!isNaN(num) && english && japanese) {
                        vocabularyData.push({
                            number: num,
                            english: english,
                            japanese: japanese
                        });
                    }
                }
            }

            if (vocabularyData.length === 0) {
                throw new Error('æœ‰åŠ¹ãªå˜èªãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
            }

            vocabularyData.sort((a, b) => a.number - b.number);
            showSuccess(`${vocabularyData.length}å€‹ã®å˜èªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
            
            const maxNum = Math.max(...vocabularyData.map(item => item.number));
            document.getElementById('endNum').value = maxNum;
            
            document.getElementById('generateTest').disabled = false;
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }

        function updateRangeStatus() {
            const startNum = parseInt(document.getElementById('startNum').value);
            const endNum = parseInt(document.getElementById('endNum').value);
            
            if (vocabularyData.length > 0) {
                const availableWords = vocabularyData.filter(item => 
                    item.number >= startNum && item.number <= endNum
                );
                
                const statusDiv = document.getElementById('rangeStatus');
                statusDiv.textContent = `æŒ‡å®šç¯„å›²å†…ã®å˜èªæ•°: ${availableWords.length}å€‹`;
                
                const questionCount = parseInt(document.getElementById('questionCount').value);
                if (availableWords.length < questionCount) {
                    statusDiv.textContent += ` (å•é¡Œæ•°ã‚’${availableWords.length}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„)`;
                    statusDiv.style.color = '#e53e3e';
                } else {
                    statusDiv.style.color = '#38a169';
                }
            }
        }

        // ãƒ†ã‚¹ãƒˆç”Ÿæˆ
        document.getElementById('generateTest').addEventListener('click', function() {
            try {
                generateTest();
                createPrintableTest();
                showSuccess('ãƒ†ã‚¹ãƒˆå•é¡Œã‚’ç”Ÿæˆã—ã¾ã—ãŸï¼å°åˆ·ã¾ãŸã¯ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã§ã”åˆ©ç”¨ãã ã•ã„ã€‚');
            } catch (error) {
                showError('ãƒ†ã‚¹ãƒˆç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
            }
        });

        function generateTest() {
            const startNum = parseInt(document.getElementById('startNum').value);
            const endNum = parseInt(document.getElementById('endNum').value);
            const questionCount = parseInt(document.getElementById('questionCount').value);
            const testType = document.getElementById('testType').value;

            const availableWords = vocabularyData.filter(item => 
                item.number >= startNum && item.number <= endNum
            );

            if (availableWords.length < questionCount) {
                throw new Error(`ç¯„å›²å†…ã®å˜èªæ•°(${availableWords.length}å€‹)ãŒå•é¡Œæ•°(${questionCount}å€‹)ã‚ˆã‚Šå°‘ãªã„ã§ã™`);
            }

            const shuffled = availableWords.sort(() => 0.5 - Math.random());
            const selectedWords = shuffled.slice(0, questionCount);

            currentTest = selectedWords.map((word, index) => {
                let questionType;
                if (testType === 'mixed') {
                    questionType = Math.random() < 0.5 ? 'english-to-japanese' : 'japanese-to-english';
                } else {
                    questionType = testType;
                }

                return {
                    number: index + 1,
                    word: word,
                    type: questionType
                };
            });
        }

        function createPrintableTest() {
            const today = new Date();
            const dateStr = `${today.getFullYear()}å¹´${today.getMonth() + 1}æœˆ${today.getDate()}æ—¥`;
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±è¨­å®š
            document.getElementById('printDate').textContent = `å®Ÿæ–½æ—¥: ${dateStr}`;
            document.getElementById('printQuestionCount').textContent = `å•é¡Œæ•°: ${currentTest.length}å•`;
            document.getElementById('printScore').textContent = `ç‚¹æ•°: _____ / ${currentTest.length}`;
            
            // å•é¡Œç”Ÿæˆ
            const questionsDiv = document.getElementById('printQuestions');
            questionsDiv.innerHTML = '';
            
            currentTest.forEach(item => {
                const question = item.type === 'english-to-japanese' 
                    ? item.word.english 
                    : item.word.japanese;
                
                const questionDiv = document.createElement('div');
                questionDiv.className = 'print-question';
                questionDiv.innerHTML = `
                    <div class="question-text">å•${item.number}. ${question}</div>
                    <div>ç­”ãˆ: <span class="answer-line"></span></div>
                `;
                questionsDiv.appendChild(questionDiv);
            });
            
            // è§£ç­”ç”Ÿæˆ
            const answersDiv = document.getElementById('printAnswers');
            answersDiv.innerHTML = '';
            
            currentTest.forEach(item => {
                const answer = item.type === 'english-to-japanese' 
                    ? item.word.japanese 
                    : item.word.english;
                
                const answerDiv = document.createElement('div');
                answerDiv.className = 'answer-item';
                answerDiv.textContent = `å•${item.number}. ${answer} (å˜èª${item.word.number})`;
                answersDiv.appendChild(answerDiv);
            });
            
            // å°åˆ·ç”¨ã‚¨ãƒªã‚¢è¡¨ç¤º
            document.getElementById('printableTest').style.display = 'block';
        }

        function showAnswers() {
            document.getElementById('answerSection').style.display = 'block';
            document.getElementById('showAnswersBtn').style.display = 'none';
            document.getElementById('hideAnswersBtn').style.display = 'inline-block';
        }

        function hideAnswers() {
            document.getElementById('answerSection').style.display = 'none';
            document.getElementById('showAnswersBtn').style.display = 'inline-block';
            document.getElementById('hideAnswersBtn').style.display = 'none';
        }

        // å…¥åŠ›å€¤å¤‰æ›´æ™‚ã«ç¯„å›²çŠ¶æ…‹æ›´æ–°
        ['startNum', 'endNum', 'questionCount'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateRangeStatus);
        });

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function showError(message) {
            const statusDiv = document.getElementById('generateStatus') || document.getElementById('fileStatus');
            statusDiv.innerHTML = `<div class="error">${message}</div>`;
        }

        function showSuccess(message) {
            const statusDiv = document.getElementById('generateStatus') || document.getElementById('fileStatus');
            statusDiv.innerHTML = `<div class="success">${message}</div>`;
        }
    </script>
</body>
</html>
